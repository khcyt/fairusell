const kh_global=Function("return globalThis;")()||Function("return this;")()||Function("return self;")();const as_module=undefined==this;const asWorker="undefined"===typeof window&&"undefined"===typeof process&&self;const cf="kh_opcua_ss";const mf="kh_opcua_ss_prototypes_esm";kh_global.kh??={};kh_global.kh.context??="undefined"!==typeof window?kh_global.parent==kh_global?"window":"iframe":"undefined"!==typeof process?"node.js":"undefined"!==typeof self?self.name??"worker":"unknown";kh_global.kh.storage??={};const cs=kh_global.kh.storage[cf]??={cf,ms:new Set};const ms=kh_global.kh.storage[mf]??={mf,cs};cs.ms.add(ms);import*as kh_js_e from"/contrib/jsm/kh_earlybird.js";import*as kh_js_c from"/contrib/jsm/kh_classes.js";import*as kh_js_f from"/contrib/jsm/kh_functions.js";const kh_js=Object.assign({...kh_js_e},{...kh_js_c},{...kh_js_f});const name=MF`${mf}`;const print_level=undefined;import{Logger}from"/contrib/jsm/kh_log.js";const kh_log=new Logger(print_level,(()=>name));import*as opcua from"node-opcua";export const{Int64_to_BigInt,UInt64_to_BigInt}=await import("/contrib/jsm/kh_opc_node_common.js");const def_func_props={enumerable:false,configurable:true,writable:true};if(!opcua.ClientSubscription.prototype.toJSON){Object.defineProperty(opcua.ClientSubscription.prototype,"toJSON",{value:function(){"use strict";if(this==null){throw new TypeError(`${kh_js.currentFunctionName()} called on null or undefined`)}return kh_js.Class.toJSON2(this,["session"])},...def_func_props})}ms.to_json_variant_override||=false;ms.to_json_statuscode_override||=false;if(true!=ms.to_json_variant_override){const ori_to_json=opcua.Variant.prototype.toJSON;Object.defineProperty(opcua.Variant.prototype,"toJSON",{value:function(){"use strict";if(this==null){throw new TypeError(`${kh_js.currentFunctionName()} called on null or undefined`)}const dt_bs=[opcua.DataType.ByteString,opcua.DataType[opcua.DataType.ByteString]];const is_bs=-1!=dt_bs.indexOf(this.dataType);const ret=ori_to_json.call(this);if(!is_bs)return ret;if(-1!=[opcua.VariantArrayType.Array,opcua.VariantArrayType[opcua.VariantArrayType.Array]].indexOf(this.arrayType)){return{...ret,value:Object.values(this.value).map((buf=>buf.toString("base64")))}}else if(-1!=[opcua.VariantArrayType.Matrix,opcua.VariantArrayType[opcua.VariantArrayType.Matrix]].indexOf(this.arrayType)){}else{return{...ret,value:this.value?.toString("base64")??""}}},...def_func_props});ms.to_json_variant_override=true}if(true!=ms.to_json_statuscode_override){Object.defineProperty(opcua.StatusCode.prototype,"toJSON",{value:function(){"use strict";if(this==null){throw new TypeError(`${kh_js.currentFunctionName()} called on null or undefined`)}return this.toJSONFull()},...def_func_props});ms.to_json_statuscode_override=true}export function get_toJSON(obj){if(!kh_js.isValid(obj))return undefined;switch(kh_js.getTypeName(obj)){case"ClientSubscriptionImpl":return function(){return kh_js.Class.toJSON(this,["khid","subscriptionId","publishingInterval","lifetimeCount","maxKeepAliveCount","maxNotificationsPerPublish","publishingEnabled","priority"])};case"ClientMonitoredItemImpl":return function(){return kh_js.Class.toJSON(this,["khid","itemToMonitor","monitoringParameters","monitoringMode","statusCode",{key:"subscription",converter:subscr=>subscr.subscriptionId}])};default:return()=>obj}}kh_global.LoadedScripts.get(mf).resolve(ms);